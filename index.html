<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Audio Visualizer</title>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0633259514526906"
     crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WL1KSYBBD5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WL1KSYBBD5');
</script>
  
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <canvas id="spiralCanvas"></canvas>
  <div id="controlsOverlay" class="controls-overlay">
    <button id="toggleControls" class="toggle-controls">Hide Controls</button>
    <h2>Audio Visualizer</h2>
    <div class="controls">
      <div class="control-group">
        <h3>Presets</h3>
        <label data-tooltip="Load a pre-configured visual design.">Load Preset: 
          <select id="presetSelector">
            <option value="">Select a Preset</option>
            <option value="custom">Custom</option>
            <!-- Options will be added via JavaScript -->
          </select>
        </label>
        <div>
          <button onclick="undo()" data-tooltip="Undo the last parameter change.">Undo</button>
          <button onclick="reset()" data-tooltip="Reset all parameters to their default values.">Reset</button>
        </div>
      </div>

      <div class="control-group">
        <h3>Master Settings</h3>
        <label data-tooltip="Automatically rotates the spiral."><input type="checkbox" id="autoRotate"> Auto-Rotate</label>
        <label data-tooltip="Makes the visualizer react to microphone input."><input type="checkbox" id="audioReactive"> Audio Reactive</label>
        <button id="audioToggleButton" style="display: none; margin-top: 5px;">Start Audio</button>
        <div id="audioOptions" style="display: none; margin-left: 20px;">
          <label data-tooltip="Makes rotation reactive to audio."><input type="checkbox" id="audioRotate"> Rotate</label>
          <label data-tooltip="Makes scale reactive to audio."><input type="checkbox" id="audioScale"> Scale</label>
          <label data-tooltip="Makes opacity reactive to audio."><input type="checkbox" id="audioOpacity"> Opacity</label>
          <label data-tooltip="Maximum amount the scale can increase with audio.">Scale Gap: <input type="range" id="scaleGap" min="1" max="50" value="10"> <span id="scaleGapValue">10</span></label>
          <label data-tooltip="How strongly the scale reacts to audio.">Scale Sensitivity: <input type="range" id="scaleSensitivity" min="0.5" max="5" step="0.1" value="1"> <span id="scaleSensitivityValue">1</span></label>
        </div>
      </div>

      <div class="control-group">
        <h3>Core Parameters</h3>
        <label data-tooltip="Controls the overall size of the spiral.">Scale: <input type="range" id="scale" min="1" max="100" step="0.1" value="30"> <span id="scaleValue">30</span></label>
        <label data-tooltip="Number of points in each spiral arm.">Nodes: <input type="range" id="nodes" min="5" max="50" value="12"> <span id="nodesValue">12</span></label>
        <label data-tooltip="Sets the starting angle of the spiral.">Rotation: <input type="range" id="rotation" min="0" max="360" value="0"> <span id="rotationValue">0</span></label>
      </div>

      <div class="control-group">
        <h3>Layer Controls</h3>
        <label data-tooltip="Number of concentric spiral layers.">Layers: <input type="range" id="layers" min="1" max="100" value="3"> <span id="layersValue">3</span></label>
        <label data-tooltip="Spacing between layers. >1 grows, <1 shrinks.">Layer Ratio: 
          <input type="range" id="layerRatio" min="0.1" max="10" step="0.1" value="2">
          <span id="layerRatioValue">2</span>
        </label>
        <div>
          <button onclick="setRatio(1.618)" data-tooltip="Set layer ratio to the Golden Ratio (φ ≈ 1.618).">Golden Ratio</button>
          <button onclick="setRatio(2.414)" data-tooltip="Set layer ratio to the Silver Ratio (δS ≈ 2.414).">Silver Ratio</button>
        </div>
      </div>

      <div class="control-group">
        <h3>Mirror Effects</h3>
        <label data-tooltip="Mirrors the spiral across the vertical axis."><input type="checkbox" id="verticalMirror"> Vertical Mirror</label>
        <label data-tooltip="Mirrors the spiral across the horizontal axis."><input type="checkbox" id="horizontalMirror"> Horizontal Mirror</label>
        <div class="mirror-colors">
          <label>Vertical Color: <input type="color" id="verticalColor" value="#FF00FF"></label>
          <label>Horizontal Color: <input type="color" id="horizontalColor" value="#FFFF00"></label>
          <label>Both Color: <input type="color" id="bothColor" value="#FFFFFF"></label>
        </div>
      </div>

      <div class="control-group">
        <h3>Style Options</h3>
        <label data-tooltip="The main color of the primary spiral.">Color: <input type="color" id="strokeColor" value="#00FFFF"></label>
        <label data-tooltip="The thickness of the spiral lines.">Line Width: <input type="range" id="lineWidth" min="1" max="10" value="2"> <span id="lineWidthValue">2</span></label>
        <label data-tooltip="The transparency of the spiral.">Opacity: <input type="range" id="opacity" min="0" max="1" step="0.1" value="1"> <span id="opacityValue">1</span></label>
        <label data-tooltip="Linear for even spacing, Logarithmic for exponential spacing.">Spiral Type: 
          <select id="spiralType">
            <option value="linear">Linear</option>
            <option value="logarithmic">Logarithmic</option>
          </select>
        </label>
        <label data-tooltip="Style of the line endings (for thick lines).">Line End Style: 
          <select id="lineEndStyle">
            <option value="boxed">Boxed</option>
            <option value="tapered">Tapered</option>
            <option value="rounded">Rounded</option>
          </select>
        </label>
        <label data-tooltip="The background color of the canvas.">Background Color: <input type="color" id="backgroundColor" value="#111111"></label>
        <label data-tooltip="Fades the line color to black along its length."><input type="checkbox" id="gradientStroke" checked> Gradient Stroke</label>
        <label data-tooltip="Renders the lines with a dashed pattern."><input type="checkbox" id="dashEffect"> Dashed Lines</label>
        <label data-tooltip="Draws smooth curves instead of straight lines between nodes."><input type="checkbox" id="curvedLines"> Curved Lines</label>
      </div>
    </div>

    <div class="download-container">
      <button onclick="downloadCanvas()" data-tooltip="Saves the current visual as a high-resolution PNG file.">Download Image (2160×2160)</button>
      <button id="fullscreenButton" data-tooltip="View the visualizer in full screen mode.">Go Fullscreen</button>
    </div>
  </div>

  <div id="fullscreenOverlay" class="fullscreen-overlay">
    Press ESC to exit full screen
  </div>

  <script src="presets.js"></script>
  <script src="webgl-setup.js"></script>
  <script src="drawing.js"></script>
  <script src="audio.js"></script>
  <script src="script.js"></script>
  <script src="state.js"></script>
  <script src="ui.js"></script>
</body>
</html>
